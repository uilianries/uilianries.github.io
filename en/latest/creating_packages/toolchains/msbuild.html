



<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>MSBuildToolchain &mdash; conan 1.30.2 documentation</title>
  

  
  
    <link rel="shortcut icon" href="../../_static/conan-favicon.png"/>
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  


  
    <link rel="stylesheet" href="../../_static/css/signup.css" type="text/css" />
  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  

  

  <link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.7/css/select2.min.css" rel="stylesheet" />
  <link rel="stylesheet" href="../../_static/css/search.css" type="text/css" />
        <link rel="index" title="Index"
              href="../../genindex.html"/>
        <link rel="search" title="Search" href="../../search.html"/>
    <link rel="top" title="conan 1.30.2 documentation" href="../../index.html"/>
        <link rel="up" title="Toolchains" href="../toolchains.html"/>
        <link rel="next" title="Inspecting Packages" href="../inspecting_packages.html"/>
        <link rel="prev" title="MakeToolchain" href="make.html"/>

 <!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-WK44ZFM');</script>
<!-- End Google Tag Manager -->
 



</script>


  

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="https://conan.io">
          

          
            
            <img src="../../_static/conan-logo.png" class="logo" />
          
          </a>

            

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../training_courses.html">Training Courses</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../installation.html">Install</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../using_packages.html">Using packages</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../creating_packages.html">Creating Packages</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../getting_started.html">Getting Started</a></li>
<li class="toctree-l2"><a class="reference internal" href="../external_repo.html">Recipe and Sources in a Different Repo</a></li>
<li class="toctree-l2"><a class="reference internal" href="../package_repo.html">Recipe and Sources in the Same Repo</a></li>
<li class="toctree-l2"><a class="reference internal" href="../existing_binaries.html">Packaging Existing Binaries</a></li>
<li class="toctree-l2"><a class="reference internal" href="../understand_packaging.html">Understanding Packaging</a></li>
<li class="toctree-l2"><a class="reference internal" href="../define_abi_compatibility.html">Defining Package ABI Compatibility</a></li>
<li class="toctree-l2"><a class="reference internal" href="../package_information.html">Define the package information</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../toolchains.html">Toolchains</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="../toolchains.html#built-in-toolchains">Built-in toolchains</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="cmake.html">CMakeToolchain</a></li>
<li class="toctree-l4"><a class="reference internal" href="make.html">MakeToolchain</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">MSBuildToolchain</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../inspecting_packages.html">Inspecting Packages</a></li>
<li class="toctree-l2"><a class="reference internal" href="../package_approaches.html">Packaging Approaches</a></li>
<li class="toctree-l2"><a class="reference internal" href="../package_tools.html">Package Creator Tools</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../uploading_packages.html">Uploading Packages</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../developing_packages.html">Developing packages</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../devtools.html">Package apps and devtools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../versioning.html">Versioning</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../mastering.html">Mastering Conan</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../systems_cross_building.html">Systems and cross building</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../extending.html">Extending Conan</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../integrations.html">Integrations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../configuration.html">Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../howtos.html">Howtos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../reference.html">Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../videos.html">Videos and links</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../faq.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../changelog.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../conan_v2.html">Road to Conan 2.0</a></li>
</ul>

            
          
          <div class="dark_newsletter-div">
             <p>Sign up for release updates:</p>
              <script src="https://app-lon04.marketo.com/js/forms2/js/forms2.min.js"></script>
              <form id="mktoForm_1479"></form>
              <script>MktoForms2.loadForm("https://app-lon04.marketo.com", "256-FNZ-187", 1479);</script>
          </div>
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">conan</a>
        
      </nav>


      
      <script>
        var reldir = "../../index.html".replace("index.html","").replace("#", "");
      </script>
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation" id="breadcrumbs">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../creating_packages.html">Creating Packages</a> &raquo;</li>
        
          <li><a href="../toolchains.html">Toolchains</a> &raquo;</li>
        
      <li>MSBuildToolchain</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            
              <a href="https://github.com/conan-io/docs/blob/master/creating_packages/toolchains/msbuild.rst" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
</div>
          <!--<select id="search" name="state" multiple="true" onchange="window.location = reldir + this.value;" style="width:90%"></select>
          <hr/>-->
          <!--<div class="admonition important"> Join the <a href=https://blog.conan.io/2020/07/28/Launching-Conan-2.0-Tribe.html>Conan 2.0 Tribe</a> and contribute to define the next Conan 2.0 major version</div>-->
          <div class="admonition important">
            <p class="admonition-title">Announcement</p>
            <p>Check out the new free <a
            href=https://blog.conan.io/2020/09/24/New-conan-training-series.html>Conan
            training courses on JFrog Academy</a>!
          </div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="msbuildtoolchain">
<h1>MSBuildToolchain<a class="headerlink" href="#msbuildtoolchain" title="Permalink to this headline">¶</a></h1>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">This is an <strong>experimental</strong> feature subject to breaking changes in future releases.</p>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">MSBuildToolchain</span></code> can be used in the <code class="docutils literal notranslate"><span class="pre">toolchain()</span></code> method:</p>
<div class="code python highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">conans</span> <span class="kn">import</span> <span class="n">ConanFile</span><span class="p">,</span> <span class="n">MSBuildToolchain</span>

<span class="k">class</span> <span class="nc">App</span><span class="p">(</span><span class="n">ConanFile</span><span class="p">):</span>
    <span class="n">settings</span> <span class="o">=</span> <span class="s2">&quot;os&quot;</span><span class="p">,</span> <span class="s2">&quot;arch&quot;</span><span class="p">,</span> <span class="s2">&quot;compiler&quot;</span><span class="p">,</span> <span class="s2">&quot;build_type&quot;</span>
    <span class="n">requires</span> <span class="o">=</span> <span class="s2">&quot;hello/0.1&quot;</span>
    <span class="n">generators</span> <span class="o">=</span> <span class="s2">&quot;msbuild&quot;</span>
    <span class="n">options</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;shared&quot;</span><span class="p">:</span> <span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">]}</span>
    <span class="n">default_options</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;shared&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">}</span>

    <span class="k">def</span> <span class="nf">toolchain</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">tc</span> <span class="o">=</span> <span class="n">MSBuildToolchain</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">tc</span><span class="o">.</span><span class="n">write_toolchain_files</span><span class="p">()</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">MSBuildToolchain</span></code> will generate two files after a <code class="docutils literal notranslate"><span class="pre">conan</span> <span class="pre">install</span></code> command or
before calling the <code class="docutils literal notranslate"><span class="pre">build()</span></code> method when the package is building in the cache:</p>
<ul class="simple">
<li>The main <em>conan_toolchain.props</em> file, that can be used in the command line.</li>
<li>A <em>conan_toolchain_&lt;config&gt;.props</em> file, that will be conditionally included from the previous
<em>conan_toolchain.props</em> file based on the configuration, platform and toolset, e.g.:
<em>conan_toolchain_Release_x86_v140.props</em></li>
</ul>
<p>Every invocation to <code class="docutils literal notranslate"><span class="pre">conan</span> <span class="pre">install</span></code> with different configuration will create a new properties <code class="docutils literal notranslate"><span class="pre">.props</span></code>
file, that will also be conditionally included. This allows to install different sets of dependencies,
then switch among them directly from the Visual Studio IDE.</p>
<p>The toolchain files can configure:</p>
<ul class="simple">
<li>The Visual Studio runtime (MT/MD/MTd/MDd), obtained from Conan input settings</li>
<li>The C++ standard, obtained from Conan input settings</li>
</ul>
<div class="section" id="generators">
<h2>Generators<a class="headerlink" href="#generators" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">MSBuildToolchain</span></code> only works with the <code class="docutils literal notranslate"><span class="pre">msbuild</span></code> generator.
Please, do not use other generators, as they can have overlapping definitions that can conflict.</p>
</div>
<div class="section" id="using-the-toolchain-in-developer-flow">
<h2>Using the toolchain in developer flow<a class="headerlink" href="#using-the-toolchain-in-developer-flow" title="Permalink to this headline">¶</a></h2>
<p>One of the advantages of using Conan toolchains is that they can help to achieve the exact same build
with local development flows, than when the package is created in the cache.</p>
<p>With the <code class="docutils literal notranslate"><span class="pre">MSBuildToolchain</span></code> it is possible to do:</p>
<div class="code bash highlight-default notranslate"><div class="highlight"><pre><span></span># Lets start in the folder containing the conanfile.py
$ mkdir build &amp;&amp; cd build
# Install both debug and release deps and create the toolchain
$ conan install ..
$ conan install .. -s build_type=Debug
# Add ``conan_toolchain.props`` in your IDE to the project properties
# No need to add the configuration .props files. This needs to be done only once
# If you have dependencies, you will need to add the .props files of the dependencies
# too, check the &quot;msbuild&quot; generator
# Open Visual Studio IDE and build, switching configurations directly in the IDE
</pre></div>
</div>
</div>
<div class="section" id="msbuild-build-helper">
<h2>MSBuild build helper<a class="headerlink" href="#msbuild-build-helper" title="Permalink to this headline">¶</a></h2>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">The existing <code class="docutils literal notranslate"><span class="pre">MSBuild</span></code> helper is not suitable to be used with toolchain yet. A new
helper will be added in future releases.</p>
</div>
<p>At the moment there is no build helper to work with the <code class="docutils literal notranslate"><span class="pre">MSBuildToolchain</span></code>. Call directly
<code class="docutils literal notranslate"><span class="pre">msbuild</span></code> in your recipes to build your project, something like:</p>
<div class="code python highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">build</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">vs_path</span> <span class="o">=</span> <span class="n">vs_installation_path</span><span class="p">(</span><span class="s2">&quot;15&quot;</span><span class="p">)</span>
    <span class="n">vcvars_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">vs_path</span><span class="p">,</span> <span class="s2">&quot;VC/Auxiliary/Build/vcvarsall.bat&quot;</span><span class="p">)</span>

    <span class="n">platform_arch</span> <span class="o">=</span> <span class="s2">&quot;x86&quot;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">arch</span> <span class="o">==</span> <span class="s2">&quot;x86&quot;</span> <span class="k">else</span> <span class="s2">&quot;x64&quot;</span>
    <span class="n">build_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">build_type</span>
    <span class="n">cmd</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;set &quot;VSCMD_START_DIR=</span><span class="si">%%</span><span class="s1">CD</span><span class="si">%%</span><span class="s1">&quot; &amp;&amp; &#39;</span>
               <span class="s1">&#39;&quot;</span><span class="si">%s</span><span class="s1">&quot; x64 &amp;&amp; msbuild &quot;MyProject.sln&quot; /p:Configuration=</span><span class="si">%s</span><span class="s1"> &#39;</span>
               <span class="s1">&#39;/p:Platform=</span><span class="si">%s</span><span class="s1"> &#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">vcvars_path</span><span class="p">,</span> <span class="n">build_type</span><span class="p">,</span> <span class="n">platform_arch</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../inspecting_packages.html" class="btn btn-neutral float-right" title="Inspecting Packages" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="make.html" class="btn btn-neutral" title="MakeToolchain" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016-2020, JFrog.
      Last updated on Oct 28, 2020.
      <span><a href="#" class="ot-sdk-show-settings">Cookies Settings</a></span>
    </p>
  </div> 

</footer>

        </div>
      </div>

    </section>

  </div>
  
  <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      <!--<span class="fa fa-pencil-square-o"> Other versions:</span> -->
      Version: 1.30
      <span class="fa fa-caret-down"></span>
    </span>
    <div class="rst-other-versions">
      <dl>
        <dt>Versions</dt>
        
          
            <dd><a href="/en/latest/index.html">1.30</a></dd>
          
        
          
            <dd><a href="/en/1.29/index.html">1.29</a></dd>
          
        
          
            <dd><a href="/en/1.28/index.html">1.28</a></dd>
          
        
          
            <dd><a href="/en/1.27/index.html">1.27</a></dd>
          
        
          
            <dd><a href="/en/1.26/index.html">1.26</a></dd>
          
        
          
            <dd><a href="/en/1.25/index.html">1.25</a></dd>
          
        
          
            <dd><a href="/en/1.24/index.html">1.24</a></dd>
          
        
          
            <dd><a href="/en/1.23/index.html">1.23</a></dd>
          
        
          
            <dd><a href="/en/1.22/index.html">1.22</a></dd>
          
        
          
            <dd><a href="/en/1.21/index.html">1.21</a></dd>
          
        
          
            <dd><a href="/en/1.20/index.html">1.20</a></dd>
          
        
          
            <dd><a href="/en/1.19/index.html">1.19</a></dd>
          
        
          
            <dd><a href="/en/1.18/index.html">1.18</a></dd>
          
        
          
            <dd><a href="/en/1.17/index.html">1.17</a></dd>
          
        
          
            <dd><a href="/en/1.16/index.html">1.16</a></dd>
          
        
          
            <dd><a href="/en/1.15/index.html">1.15</a></dd>
          
        
          
            <dd><a href="/en/1.14/index.html">1.14</a></dd>
          
        
          
            <dd><a href="/en/1.13/index.html">1.13</a></dd>
          
        
          
            <dd><a href="/en/1.12/index.html">1.12</a></dd>
          
        
          
            <dd><a href="/en/1.11/index.html">1.11</a></dd>
          
        
          
            <dd><a href="/en/1.10/index.html">1.10</a></dd>
          
        
          
            <dd><a href="/en/1.9/index.html">1.9</a></dd>
          
        
          
            <dd><a href="/en/1.8/index.html">1.8</a></dd>
          
        
          
            <dd><a href="/en/1.7/index.html">1.7</a></dd>
          
        
          
            <dd><a href="/en/1.6/index.html">1.6</a></dd>
          
        
          
            <dd><a href="/en/1.5/index.html">1.5</a></dd>
          
        
          
            <dd><a href="/en/1.4/index.html">1.4</a></dd>
          
        
          
            <dd><a href="/en/1.3/index.html">1.3</a></dd>
          
        
      </dl>
      <dl>
        <dt>Downloads</dt>
        
          <dd><a href="/en/latest/conan.pdf">PDF</a></dd>
        
      </dl>
    </div>
  </div>

  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'1.30.2',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  <!-- <script
  src="https://code.jquery.com/jquery-3.4.1.min.js"
  integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo="
  crossorigin="anonymous"></script>
  <script src="../../_static/js/modernizr.min.js"></script>
  <script src="../../_static/js/search.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.7/js/select2.min.js"></script>
-->
  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
  


  <script>
    // initSearch("1.30");
  </script>

<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-WK44ZFM" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>


 


</body>
</html>